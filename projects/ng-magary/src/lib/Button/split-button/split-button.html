<div
  [class]="
    'magary-split-button ' + styleClass() + (disabled() ? ' disabled' : '')
  "
>
  <button
    type="button"
    class="default-button"
    [disabled]="disabled()"
    (click)="onDefaultClick($event)"
  >
    @if (icon()) {
      <lucide-icon
        [name]="icon()"
        [size]="iconSize()"
        class="button-icon"
      ></lucide-icon>
    }
    <span class="button-label">{{ label() }}</span>
  </button>

  <button
    type="button"
    class="dropdown-trigger"
    [disabled]="disabled()"
    [class.active]="isOpen()"
    (click)="toggleDropdown($event)"
  >
    <lucide-icon name="chevron-down"></lucide-icon>
  </button>

  @if (isOpen()) {
    <div class="split-button-menu">
      <ul role="menu">
        @for (item of model(); track item.label || $index) {
          <li
            role="menuitem"
            [class.disabled]="item.disabled"
            (click)="onItemClick($event, item)"
          >
            @if (item.icon) {
              <lucide-icon
                [name]="item.icon"
                [size]="iconSize()"
                class="menu-item-icon"
              ></lucide-icon>
            }
            <span class="menu-item-label">{{ item.label }}</span>
          </li>
        }
      </ul>
    </div>
  }
</div>
